import{v as b,a3 as w,a8 as v,a4 as R,D as g,V as A,q as d,P as _,ae as k,X as N,E as S,H as m,af as D,J as O,ag as C,K as H,M as F,F as M,O as T,t as I,ah as P,ai as L,Q as Y,ab as y,aj as G,ak as V,al as E,am as j,an as q,ao as B,G as p}from"./template.BDeKVD2u.js";class J{anchor;#s=new Map;#t=new Map;#e=new Map;#a=new Set;#i=!0;constructor(i,s=!0){this.anchor=i,this.#i=s}#r=()=>{var i=b;if(this.#s.has(i)){var s=this.#s.get(i),e=this.#t.get(s);if(e)w(e),this.#a.delete(s);else{var n=this.#e.get(s);n&&(this.#t.set(s,n.effect),this.#e.delete(s),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),e=n.effect)}for(const[r,f]of this.#s){if(this.#s.delete(r),r===i)break;const t=this.#e.get(f);t&&(v(t.effect),this.#e.delete(f))}for(const[r,f]of this.#t){if(r===s||this.#a.has(r))continue;const t=()=>{if(Array.from(this.#s.values()).includes(r)){var c=document.createDocumentFragment();k(f,c),c.append(g()),this.#e.set(r,{effect:f,fragment:c})}else v(f);this.#a.delete(r),this.#t.delete(r)};this.#i||!e?(this.#a.add(r),R(f,t,!1)):t()}}};#f=i=>{this.#s.delete(i);const s=Array.from(this.#s.values());for(const[e,n]of this.#e)s.includes(e)||(v(n.effect),this.#e.delete(e))};ensure(i,s){var e=b,n=N();if(s&&!this.#t.has(i)&&!this.#e.has(i))if(n){var r=document.createDocumentFragment(),f=g();r.append(f),this.#e.set(i,{effect:A(()=>s(f)),fragment:r})}else this.#t.set(i,A(()=>s(this.anchor)));if(this.#s.set(e,i),n){for(const[t,a]of this.#t)t===i?e.unskip_effect(a):e.skip_effect(a);for(const[t,a]of this.#e)t===i?e.unskip_effect(a.effect):e.skip_effect(a.effect);e.oncommit(this.#r),e.ondiscard(this.#f)}else d&&(this.anchor=_),this.#r()}}function Q(u,i,s=!1){var e;d&&(e=_,m());var n=new J(u),r=s?D:0;function f(t,a){if(d){var c=O(e),o;if(c===C?o=0:c===H?o=!1:o=parseInt(c.substring(1)),t!==o){var h=F();M(h),n.anchor=h,T(!1),n.ensure(t,a),T(!0);return}}n.ensure(t,a)}S(()=>{var t=!1;i((a,c=0)=>{t=!0,f(c,a)}),t||f(!1,null)},r)}function X(u,i,s=!1,e=!1,n=!1){var r=u,f="";I(()=>{var t=P;if(f===(f=i()??"")){d&&m();return}if(t.nodes!==null&&(L(t.nodes.start,t.nodes.end),t.nodes=null),f!==""){if(d){_.data;for(var a=m(),c=a;a!==null&&(a.nodeType!==Y||a.data!=="");)c=a,a=y(a);if(a===null)throw G(),V;E(_,c),r=M(a);return}var o=s?q:e?B:void 0,h=j(s?"svg":e?"math":"template",o);h.innerHTML=f;var l=s||e?h:h.content;if(E(p(l),l.lastChild),s||e)for(;p(l);)r.before(p(l));else r.before(l)}})}export{X as h,Q as i};
